{% extends "base.html" %}

{% block scripts %}
  <script>
    $(function() {
        var elements = document.getElementsByClassName("coloreable");
        var coloreable;
        for (var i = 0; i < elements.length; i++) {
            coloreable = elements[i];
            num = coloreable.innerHTML;
            if (num <= 2) {
                coloreable.className += " verde";
            } else if (num <= 4) {
                coloreable.className += " amarillo";
            } else if (num >= 5) {
                coloreable.className += " rojo";
            }
        }
    });
    
    $(function() {
        var elements = document.getElementsByClassName("hidden-coloreable");
        var coloreable;
        for (var i = 0; i < elements.length; i++) {
            coloreable = elements[i];
            bool = coloreable.innerHTML;
            if (bool == 1) {
                $(elements[i]).parent().addClass("amarillo_claro");
            }
        }
    });
    
    function dar_alta( item ) {
        if (confirm("Realmente desea dar de alta a este paciente?")) {
            $( item ).find('img').attr("src", "/static/img/alta_dis.png");
        //     $( item ).innerHTML = "En proceso";
            var $objeto = $( item ).parent().parent();
            $objeto.removeClass();
            $objeto.addClass("azul_claro");
        }
    }  
  </script>
{% endblock %}

{% block body %}
  <div class="row">
    <div class="cuadroGrande centrar">
      <div class="titulo">
        Censo
      </div>
      <br/>
      <h4><center> Al d&iacute;a {{ hoy }} </center></h4>
      </br>
      {% if ingresos %}
      <table class="table table-bordered centrado">
        <tr>
            <th>N&uacute;mero de Habitaci&oacute;n</th>
            <th>Paciente</th>
            <th>M&eacute;dico</th>
            <th>Fecha estimada de salida</th>
            <th>Nro. D&iacute;as en la habitaci&oacute;n</th>
            <th>Nro. D&iacute;as en la instituci&oacute;n</th>
            <th>Procedencia</th>
			<th>Dar alta</th>
        </tr>
        {% for ingreso in ingresos %}
        
        <tr style="text-align: center" class="alta-{{ ingreso.alta }}">
            <td class="hidden-coloreable" style="display: none;">
                {{ ingreso.es_hoy }}
            </td>
            <td style="font-size: 18px; text-align: center">
                {{ ingreso.habitacion.numero }}
            </td>
            <td>
                {{ ingreso.solicitud.paciente }}
            </td>
            <td>
                Dr. {{ ingreso.solicitud.medico }}
            </td>
            <td style="text-align: center; width: 100px">
                {{ ingreso.solicitud.salida }}
            </td>
            <td class="coloreable" style="text-align: center">
                {{ ingreso.num_dias }}
            </td>
            <td class="coloreable" style="text-align: center">
                {{ ingreso.solicitud.paciente.ingreso }}
            </td>
            <td>
                {{ ingreso.procedencia }}
            </td>
			<td style="text-align: center">
				<a onclick="dar_alta(this);" href="#"><img class = "marginleft5 width40" src="/static/img/alta_en.png" /></a>
			</td>
        </tr>
        
       {% endfor %}
      </table>
      {% else %}
      <h4>No hay pacientes en este momento.</h4>
      {% endif %}
    </div>
  </div>
{% endblock %}